<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Delícias da Cássia • Pedidos</title>

  <script type="module">
    import { WHATS_DISPLAY, WHATS_NUM, PIX, BAIRROS, TIMEZONE, BUSINESS_HOURS, CLOSE_BEHAVIOR } from "./config.js";

    // ---------- Horário ----------
    function toMinutes(hhmm){ const [h,m]=hhmm.split(':').map(n=>parseInt(n||0,10)); return h*60+(m||0); }
    function nowInTZ(tz){
      const fmt = new Intl.DateTimeFormat("pt-BR",{ timeZone: tz, hour:"2-digit", minute:"2-digit", weekday:"short" });
      const parts = Object.fromEntries(fmt.formatToParts(new Date()).map(p=>[p.type,p.value]));
      const map = { dom:0, seg:1, ter:2, qua:3, qui:4, sex:5, sáb:6, sab:6 };
      const w = (parts.weekday||"").toLowerCase().slice(0,3);
      return { dow: (map[w] ?? new Date().getDay()), mins: toMinutes(`${parts.hour}:${parts.minute}`) };
    }
    function isOpenNow(tz, hoursMap){
      const { dow, mins } = nowInTZ(tz);
      const ranges = hoursMap[dow] || [];
      for(const r of ranges){
        const [a,b]=r.split("-");
        if(mins>=toMinutes(a) && mins<=toMinutes(b)) return { open:true, today:ranges, ends:b };
      }
      return { open:false, today:ranges };
    }
    function todayHoursLabel(){ return "sábados e domingos, das 11:00 às 15:00"; }

    // ---------- Utilidades ----------
    const parseMoney = v => { if(!v) return 0; v=(''+v).replace('R$','').replace('.','').replace(',','.'); v=parseFloat(v); return isNaN(v)?0:v; };
    const formatBR = n => "R$ "+n.toFixed(2).replace(".",",");

    // Normalização compatível com iOS (remove acentos)
    const normalize = (s) => (s||"")
      .normalize("NFD").replace(/[\u0300-\u036f]/g,"")
      .replace(/\s+/g," ").trim().toUpperCase();

    let _isOpen = false;

    window.app = {
      cartLines: [],

      init(){
        document.getElementById("whatsPill").textContent = "WhatsApp: " + WHATS_DISPLAY;

        // bairros
        const sel = document.getElementById("bairroSel");
        sel.innerHTML = '<option value="">Selecione o bairro</option>';
        BAIRROS.forEach(b=>{
          const o=document.createElement("option");
          o.value=b.bairro+"|"+b.taxa;
          o.textContent=b.bairro;
          sel.appendChild(o);
        });

        // PIX
        document.getElementById("pixKey").textContent  = PIX.key;
        document.getElementById("pixBank").textContent = PIX.bank;
        document.getElementById("pixName").textContent = PIX.name;

        this.recalc(); this.onTipoChange(); this.onPagamentoChange();
        this.applyStock();

        try{
          this.updateOpenStatus();
          setInterval(()=>this.updateOpenStatus(), 60000);
        }catch(e){
          console.error(e);
          const pill = document.getElementById("statusPill");
          pill.textContent = "Não foi possível verificar horário";
          pill.classList.add("closed");
        }
      },

      updateOpenStatus(){
        const status = isOpenNow(TIMEZONE, BUSINESS_HOURS);
        _isOpen = status.open;
        const pill = document.getElementById("statusPill");
        const banner = document.getElementById("closedBanner");

        if(status.open){
          pill.textContent = "Aberto até " + (status.ends || "15:00");
          pill.classList.remove("closed"); pill.classList.add("open");
          if(CLOSE_BEHAVIOR.showBanner && banner) banner.style.display = "none";
        } else {
          pill.textContent = "Fechado • Funcionamos aos " + todayHoursLabel();
          pill.classList.remove("open"); pill.classList.add("closed");
          if(CLOSE_BEHAVIOR.showBanner && banner){
            banner.style.display="block";
            document.getElementById("todayHoursText").textContent = todayHoursLabel();
          }
        }
        this.enforceCheckoutBlock();
      },

      enforceCheckoutBlock(){
        if(!CLOSE_BEHAVIOR.blockCheckout) return;
        const btn = document.getElementById("sendBtn");
        if(btn) btn.disabled = true; // começa travado
        if(_isOpen){ this.updateSendState(); } // libera se aberto e requisitos OK
      },

      applyStock(){
        const sold = (window.ESGOTADOS || []).map(normalize);
        document.querySelectorAll(".item").forEach(it=>{
          const nameEl = it.querySelector(".name");
          const raw = nameEl?.childNodes[0]?.textContent || nameEl?.textContent || "";
          const name = normalize(raw);
          const isSold = sold.includes(name) || sold.some(s => name.includes(s));
          if(isSold){
            it.classList.add("soldout");
            const input = it.querySelector('input[type="number"]');
            const minus = it.querySelector("button:nth-of-type(1)");
            const plus  = it.querySelector("button:nth-of-type(2)");
            if(input){ input.value = 0; input.disabled = true; }
            if(minus){ minus.disabled = true; }
            if(plus){ plus.disabled = true; }
            if(!it.querySelector(".badge-soldout")){
              const badge = document.createElement("span");
              badge.className = "badge-soldout";
              badge.textContent = "ESGOTADO";
              nameEl?.appendChild(badge);
            }
          }
        });
        this.recalc();
      },

      isSoldOutItem(btn){
        const it = btn.closest(".item");
        return it?.classList?.contains("soldout");
      },

      chg(btn,delta){
        if(this.isSoldOutItem(btn)) return;
        const i=btn.parentElement.querySelector("input");
        let v=parseInt(i.value||0)+delta; if(v<0) v=0;
        i.value=v; this.recalc();
      },

      recalc(){
        const items=[...document.querySelectorAll(".item")]; let subtotal=0; const lines=[];
        items.forEach(it=>{
          const q=parseInt(it.querySelector("input")?.value||0);
          if(q>0){
            const name=(it.querySelector(".name").childNodes[0].textContent||"").trim();
            const price=parseFloat(it.querySelector(".price")?.dataset.price||"0");
            subtotal+=price*q; lines.push({name,qty:q,price});
          }
        });
        const taxa=parseMoney(document.getElementById("taxa").value);
        document.getElementById("cartItems").innerHTML = lines.length ? lines.map(l=>`• ${l.qty}× ${l.name} — ${formatBR(l.price)}`).join("<br>") : "Nenhum item ainda.";
        document.getElementById("subtotal").textContent=formatBR(subtotal);
        document.getElementById("frete").textContent=formatBR(taxa||0);
        document.getElementById("total").textContent=formatBR(subtotal+(taxa||0));
        this.cartLines = lines;
        this.updateSendState();
      },

      onTipoChange(){
        const tipo=document.getElementById("tipo").value;
        document.getElementById("enderecoBox").classList.toggle("hide", tipo!=="entrega");
        this.updateSendState();
      },

      selecionarBairro(){
        const v=document.getElementById("bairroSel").value; let taxa="0,00";
        if(v&&v.includes("|")) taxa=v.split("|")[1];
        document.getElementById("taxa").value=taxa;
        document.getElementById("taxaView").textContent="R$ "+taxa;
        this.recalc();
      },

      onPagamentoChange(){
        const v=document.getElementById("pagamento").value;
        document.getElementById("trocoBox").classList.toggle("hide", v!=="dinheiro");
        document.getElementById("pixBox").classList.toggle("hide", v!=="pix");
      },

      updateSendState(){
        const btn=document.getElementById("sendBtn");
        if(!btn) return;
        if(CLOSE_BEHAVIOR.blockCheckout && !_isOpen){ btn.disabled=true; return; }
        const tipo=document.getElementById("tipo").value;
        if(tipo==="retirada"){ btn.disabled=false; return; }
        const hasBairro=!!document.getElementById("bairroSel").value;
        btn.disabled=!hasBairro;
      },

      copyPix(){ navigator.clipboard.writeText(PIX.key).then(()=>alert("Chave PIX copiada!")); },

      finalizar(){
        if(CLOSE_BEHAVIOR.blockCheckout && !_isOpen){
          alert("Estamos fechados agora. Funcionamos aos sábados e domingos, das 11:00 às 15:00.");
          return;
        }

        const nome=document.getElementById("nome").value.trim();
        if(!nome){ alert("Informe seu nome."); return; }
        const tipo=document.getElementById("tipo").value;
        const bairroSel=document.getElementById("bairroSel");
        const bairroTxt=bairroSel.options[bairroSel.selectedIndex]?.text||"";
        if(tipo==="entrega" && !bairroTxt){ alert("Selecione o bairro."); return; }

        const subtotal = parseMoney(document.getElementById("subtotal").textContent);
        const entrega  = parseMoney(document.getElementById("frete").textContent);
        const total    = parseMoney(document.getElementById("total").textContent);

        const cartLines = document.getElementById("cartItems").innerHTML.replaceAll("<br>","\n");

        // Data/hora BR com timezone
        const agora = new Date();
        const dataHora = agora.toLocaleString("pt-BR", { timeZone: TIMEZONE });

        let msg = `*Delícias da Cássia*\n*Pedido Online*\n`;
        msg += `*Data/Hora:* ${dataHora}\n`;
        msg += `*Cliente:* ${nome}\n`;
        const fone=document.getElementById("fone").value.trim();
        if(fone) msg += `*WhatsApp:* ${fone}\n`;
        msg += `*Tipo:* ${tipo==="entrega"?"Entrega":"Retirada"}\n";
        if(tipo==="entrega"){ msg += `*Endereço:* ${document.getElementById("rua").value.trim()}, ${bairroTxt}\n`; }
        msg += `\n*Itens:*\n${cartLines||"-"}\n`;
        msg += `\n*Subtotal:* R$ ${subtotal.toFixed(2).replace(".",",")}\n*Entrega:* R$ ${entrega.toFixed(2).replace(".",",")}\n*Total:* R$ ${total.toFixed(2).replace(".",",")}\n`;
        const pag=document.getElementById("pagamento").value;
        msg += `\n*Pagamento:* ${pag.toUpperCase()}`;
        const troco=document.getElementById("troco").value.trim();
        if(pag==="dinheiro" && troco){ msg += ` (troco para ${troco})`; }
        const obs=document.getElementById("obs").value.trim();
        if(obs){ msg += `\n*Obs.:* ${obs}`; }
        if(pag==="pix"){
          msg += `\n\n*PIX para pagamento:*\n• Chave: ${PIX.key}\n• Banco: ${PIX.bank}\n• Titular: ${PIX.name}\n`;
          msg += `\n*Atenção:* o pedido será confirmado mediante o envio do comprovante.`;
        }

        const encoded = encodeURIComponent(msg);
        window.open(`https://wa.me/${WHATS_NUM}?text=${encoded}`,"_blank");
        alert("Pedido enviado!");
        location.reload();
      }
    };

    window.addEventListener("DOMContentLoaded", ()=> app.init());
  </script>

  <style>
    :root{--bg:#f7f5ef;--ink:#222;--muted:#666;--card:#fff;--brand:#000;--line:#e7e1d2;--accent:#111}
    *{box-sizing:border-box}
    body{margin:0;background:var(--bg);color:var(--ink);font:16px/1.45 system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,Noto Sans,Arial}
    header{position:sticky;top:0;background:var(--brand);color:#fff;padding:10px 16px 14px;z-index:10;text-align:center}
    header img{height:84px;width:auto;display:block;margin:6px auto 4px}
    header h1{margin:0;font-size:18px;letter-spacing:.5px}
    .pill{display:inline-block;padding:4px 8px;border:1px solid #ddd;border-radius:999px;font-size:12px;color:#555;background:#fafafa;margin-top:6px}
    .pill.open{background:#e9f8ec;border-color:#b9e6c3;color:#0a7a0a}
    .pill.closed{background:#fff3f0;border-color:#ffd6cc;color:#a23}
    .wrap{max-width:1100px;margin:0 auto;padding:16px}
    .grid{display:grid;grid-template-columns:1fr 360px;gap:14px}
    @media(max-width:980px){.grid{grid-template-columns:1fr}}
    .card{background:var(--card);border:1px solid var(--line);border-radius:14px;padding:12px}
    h2{margin:6px 0 10px;font-size:16px;letter-spacing:.06em;text-transform:uppercase}
    .muted{color:var(--muted);font-size:13px}
    .item{display:grid;grid-template-columns:1fr 90px 90px;gap:8px;align-items:center;padding:8px 0;border-bottom:1px dashed var(--line)}
    .item:last-child{border-bottom:0}
    .name{font-weight:600}
    .price{text-align:right;color:#333}
    .qty{display:flex;gap:6px;justify-content:flex-end;align-items:center}
    .qty button{width:28px;height:28px;border:1px solid #ccc;background:#fff;border-radius:8px;cursor:pointer}
    .qty input{width:46px;text-align:center;border:1px solid #ccc;border-radius:8px;height:28px}
    label{font-size:14px;color:#333}
    input[type=text],input[type=tel],select,textarea{width:100%;padding:10px 12px;border:1px solid #ccc;border-radius:10px;background:#fff}
    textarea{min-height:84px}
    .cart{position:sticky;top:110px}
    .cart .row{display:flex;justify-content:space-between;margin:6px 0;color:#333}
    .cart .row.total{font-weight:700;font-size:18px;border-top:1px solid #eee;padding-top:8px}
    .btn{display:inline-flex;justify-content:center;align-items:center;width:100%;padding:14px 16px;border:none;border-radius:12px;background:var(--accent);color:#fff;font-weight:700;cursor:pointer;margin-top:8px;font-size:16px}
    .btn[disabled]{opacity:.45;pointer-events:none}
    .pixbox{border:1px dashed var(--line);background:#fcfbf7;border-radius:12px;padding:10px;margin-top:8px}
    .hide{display:none}
    .item.soldout{opacity:.55;pointer-events:none}
    .badge-soldout{display:inline-block;margin-left:8px;padding:2px 6px;font-size:12px;border-radius:8px;background:#333;color:#fff}
  </style>
</head>
<body>
<header>
  <img src="logo.png" alt="Logo Delícias da Cássia" />
  <h1>DELÍCIAS DA CÁSSIA • Pedidos</h1>
  <div style="display:flex; gap:8px; justify-content:center; flex-wrap:wrap">
    <span id="statusPill" class="pill">Verificando horário…</span>
    <span id="whatsPill" class="pill"></span>
  </div>
</header>

<div id="closedBanner" class="pill" style="display:none; max-width:1100px; margin:10px auto; text-align:center; background:#fff3f0; border-color:#ffd6cc; color:#a23;">
  Estamos fechados agora. Funcionamos <span id="todayHoursText">sábados e domingos, das 11:00 às 15:00</span>.
</div>

<div class="wrap grid">
  <main class="card">
    <section id="pratos">
      <h2>Pratos Individuais</h2>
      <div class="item"><div class="name">MINI EMPADÃO DE FRANGO C/ REQUEIJÃO</div><div class="price" data-price="20.00">R$ 20,00</div><div class="qty"><button onclick="app.chg(this,-1)">−</button><input type="number" min="0" value="0"><button onclick="app.chg(this,1)">+</button></div></div>
      <div class="item"><div class="name">LASANHA</div><div class="price" data-price="20.00">R$ 20,00</div><div class="qty"><button onclick="app.chg(this,-1)">−</button><input type="number" min="0" value="0"><button onclick="app.chg(this,1)">+</button></div></div>
      <div class="item"><div class="name">ESCONDIDINHO DE CHARQUE</div><div class="price" data-price="20.00">R$ 20,00</div><div class="qty"><button onclick="app.chg(this,-1)">−</button><input type="number" min="0" value="0"><button onclick="app.chg(this,1)">+</button></div></div>
      <div class="item"><div class="name">MACARRÃO NA PRESSÃO</div><div class="price" data-price="15.00">R$ 15,00</div><div class="qty"><button onclick="app.chg(this,-1)">−</button><input type="number" min="0" value="0"><button onclick="app.chg(this,1)">+</button></div></div>
    </section>

    <section id="porcoes-ind">
      <h2>Porções Individuais <span class="muted">R$ 20,00</span></h2>
      <div class="muted" style="margin:-4px 0 8px">Serve 1 pessoa • Acompanha: arroz, farofa e vinagrete</div>
      <div class="item"><div class="name">FEIJOADA</div><div class="price" data-price="20.00">R$ 20,00</div><div class="qty"><button onclick="app.chg(this,-1)">−</button><input type="number" min="0" value="0"><button onclick="app.chg(this,1)">+</button></div></div>
      <div class="item"><div class="name">DOBRADINHA</div><div class="price" data-price="20.00">R$ 20,00</div><div class="qty"><button onclick="app.chg(this,-1)">−</button><input type="number" min="0" value="0"><button onclick="app.chg(this,1)">+</button></div></div>
      <div class="item"><div class="name">SARAPATEL</div><div class="price" data-price="20.00">R$ 20,00</div><div class="qty"><button onclick="app.chg(this,-1)">−</button><input type="number" min="0" value="0"><button onclick="app.chg(this,1)">+</button></div></div>
      <div class="item"><div class="name">MARISCO</div><div class="price" data-price="20.00">R$ 20,00</div><div class="qty"><button onclick="app.chg(this,-1)">−</button><input type="number" min="0" value="0"><button onclick="app.chg(this,1)">+</button></div></div>
    </section>

    <section id="porcoes-500">
      <h2>Porções (500 ml) <span class="muted">R$ 30,00</span></h2>
      <div class="muted" style="margin:-4px 0 8px">Servem até 2 pessoas • Acompanha: arroz, farofa e vinagrete</div>
      <div class="item"><div class="name">FEIJOADA</div><div class="price" data-price="30.00">R$ 30,00</div><div class="qty"><button onclick="app.chg(this,-1)">−</button><input type="number" min="0" value="0"><button onclick="app.chg(this,1)">+</button></div></div>
      <div class="item"><div class="name">DOBRADINHA</div><div class="price" data-price="30.00">R$ 30,00</div><div class="qty"><button onclick="app.chg(this,-1)">−</button><input type="number" min="0" value="0"><button onclick="app.chg(this,1)">+</button></div></div>
      <div class="item"><div class="name">SARAPATEL</div><div class="price" data-price="30.00">R$ 30,00</div><div class="qty"><button onclick="app.chg(this,-1)">−</button><input type="number" min="0" value="0"><button onclick="app.chg(this,1)">+</button></div></div>
      <div class="item"><div class="name">MARISCO</div><div class="price" data-price="30.00">R$ 30,00</div><div class="qty"><button onclick="app.chg(this,-1)">−</button><input type="number" min="0" value="0"><button onclick="app.chg(this,1)">+</button></div></div>
    </section>

    <section id="porcoes-1000">
      <h2>Porções (1000 ml) <span class="muted">R$ 55,00</span></h2>
      <div class="muted" style="margin:-4px 0 8px">Servem até 4 pessoas • Acompanha: arroz, farofa e vinagrete</div>
      <div class="item"><div class="name">FEIJOADA</div><div class="price" data-price="55.00">R$ 55,00</div><div class="qty"><button onclick="app.chg(this,-1)">−</button><input type="number" min="0" value="0"><button onclick="app.chg(this,1)">+</button></div></div>
      <div class="item"><div class="name">DOBRADINHA</div><div class="price" data-price="55.00">R$ 55,00</div><div class="qty"><button onclick="app.chg(this,-1)">−</button><input type="number" min="0" value="0"><button onclick="app.chg(this,1)">+</button></div></div>
      <div class="item"><div class="name">SARAPATEL</div><div class="price" data-price="55.00">R$ 55,00</div><div class="qty"><button onclick="app.chg(this,-1)">−</button><input type="number" min="0" value="0"><button onclick="app.chg(this,1)">+</button></div></div>
      <div class="item"><div class="name">MARISCO</div><div class="price" data-price="55.00">R$ 55,00</div><div class="qty"><button onclick="app.chg(this,-1)">−</button><input type="number" min="0" value="0"><button onclick="app.chg(this,1)">+</button></div></div>
    </section>

    <section id="extras">
      <h2>Porções Extras</h2>
      <div class="item"><div class="name">ARROZ P</div><div class="price" data-price="4.00">R$ 4,00</div><div class="qty"><button onclick="app.chg(this,-1)">−</button><input type="number" min="0" value="0"><button onclick="app.chg(this,1)">+</button></div></div>
      <div class="item"><div class="name">ARROZ G</div><div class="price" data-price="8.00">R$ 8,00</div><div class="qty"><button onclick="app.chg(this,-1)">−</button><input type="number" min="0" value="0"><button onclick="app.chg(this,1)">+</button></div></div>
      <div class="item"><div class="name">FAROFA</div><div class="price" data-price="4.00">R$ 4,00</div><div class="qty"><button onclick="app.chg(this,-1)">−</button><input type="number" min="0" value="0"><button onclick="app.chg(this,1)">+</button></div></div>
      <div class="item"><div class="name">EMBALAGEM</div><div class="price" data-price="2.00">R$ 2,00</div><div class="qty"><button onclick="app.chg(this,-1)">−</button><input type="number" min="0" value="0"><button onclick="app.chg(this,1)">+</button></div></div>
    </section>

    <section id="sobremesa">
      <h2>Sobremesa</h2>
      <div class="item"><div class="name">PUDIM DE LEITE</div><div class="price" data-price="7.00">R$ 7,00</div><div class="qty"><button onclick="app.chg(this,-1)">−</button><input type="number" min="0" value="0"><button onclick="app.chg(this,1)">+</button></div></div>
    </section>

    <section id="bebidas">
      <h2>Bebidas</h2>
      <div class="item"><div class="name">COCA-COLA LATA 350 ML</div><div class="price" data-price="5.00">R$ 5,00</div><div class="qty"><button onclick="app.chg(this,-1)">−</button><input type="number" min="0" value="0"><button onclick="app.chg(this,1)">+</button></div></div>
      <div class="item"><div class="name">GUARANÁ ANTARCTICA LATA 350 ML</div><div class="price" data-price="5.00">R$ 5,00</div><div class="qty"><button onclick="app.chg(this,-1)">−</button><input type="number" min="0" value="0"><button onclick="app.chg(this,1)">+</button></div></div>
      <div class="item"><div class="name">FANTA LATA 350 ML</div><div class="price" data-price="5.00">R$ 5,00</div><div class="qty"><button onclick="app.chg(this,-1)">−</button><input type="number" min="0" value="0"><button onclick="app.chg(this,1)">+</button></div></div>
      <div class="item"><div class="name">COCA-COLA PET 1 L</div><div class="price" data-price="8.00">R$ 8,00</div><div class="qty"><button onclick="app.chg(this,-1)">−</button><input type="number" min="0" value="0"><button onclick="app.chg(this,1)">+</button></div></div>
      <div class="item"><div class="name">GUARANÁ ANTARCTICA PET 1 L</div><div class="price" data-price="8.00">R$ 8,00</div><div class="qty"><button onclick="app.chg(this,-1)">−</button><input type="number" min="0" value="0"><button onclick="app.chg(this,1)">+</button></div></div>
      <div class="item"><div class="name">COCA-COLA PET 2 L</div><div class="price" data-price="13.00">R$ 13,00</div><div class="qty"><button onclick="app.chg(this,-1)">−</button><input type="number" min="0" value="0"><button onclick="app.chg(this,1)">+</button></div></div>
    </section>
  </main>

  <aside class="card cart">
    <h2>Seu Pedido</h2>
    <div id="cartItems" class="muted">Nenhum item ainda.</div>
    <div class="row"><span>Subtotal</span><span id="subtotal">R$ 0,00</span></div>
    <div class="row"><span>Entrega</span><span id="frete">R$ 0,00</span></div>
    <div class="row total"><span>Total</span><span id="total">R$ 0,00</span></div>

    <div style="margin-top:10px">
      <h2>Entrega ou Retirada</h2>
      <select id="tipo" onchange="app.onTipoChange()">
        <option value="retirada">Retirada no local</option>
        <option value="entrega">Entrega</option>
      </select>
      <div id="enderecoBox" class="hide" style="margin-top:10px">
        <div style="display:grid;grid-template-columns:1fr 1fr;gap:10px">
          <div><label>Rua</label><input id="rua" type="text" placeholder="Rua, nº" /></div>
          <div><label>Bairro</label><select id="bairroSel" onchange="app.selecionarBairro()"></select></div>
        </div>
        <div style="display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-top:8px">
          <div><label>Complemento</label><input id="compl" type="text" placeholder="Apto/Casa/Ref." /></div>
          <div><label>Taxa de entrega</label><div id="taxaView" class="pill" style="height:40px;display:flex;align-items:center;justify-content:center">R$ 0,00</div></div>
        </div>
        <input id="taxa" type="hidden" value="0" />
      </div>
    </div>

    <div style="margin-top:10px">
      <h2>Seus Dados</h2>
      <div style="display:grid;grid-template-columns:1fr 1fr;gap:10px">
        <div><label>Nome</label><input id="nome" type="text" placeholder="Seu nome" /></div>
        <div><label>WhatsApp</label><input id="fone" type="tel" placeholder="(DDD) 9xxxx-xxxx" /></div>
      </div>
      <div style="margin-top:8px">
        <label>Observações</label>
        <textarea id="obs" placeholder="Ex.: sem coentro, entregar às 12h..."></textarea>
      </div>
    </div>

    <div style="margin-top:10px">
      <h2>Pagamento</h2>
      <select id="pagamento" onchange="app.onPagamentoChange()">
        <option value="pix">PIX</option>
        <option value="dinheiro">Dinheiro</option>
        <option value="cartao">Cartão (na entrega/retirada)</option>
      </select>

      <div id="pixBox" class="pixbox hide">
        <div><strong>Chave PIX:</strong> <span id="pixKey"></span> <button onclick="app.copyPix()">Copiar</button></div>
        <div><strong>Banco:</strong> <span id="pixBank"></span></div>
        <div><strong>Titular:</strong> <span id="pixName"></span></div>
        <div class="small" style="color:#0a7a0a"><strong>Atenção:</strong> o pedido será confirmado mediante o envio do comprovante.</div>
      </div>

      <div id="trocoBox" class="hide" style="margin-top:8px">
        <label>Troco para (R$)</label>
        <input id="troco" type="text" placeholder="Ex.: 50,00" />
      </div>
    </div>

    <button id="sendBtn" class="btn" onclick="app.finalizar()" disabled>Enviar pedido via WhatsApp</button>
  </aside>
</div>
</body>
</html>
